DELIMITER $$

-- Event to update bookings to CHECKING on drop-off date
CREATE EVENT IF NOT EXISTS update_booking_to_checking
ON SCHEDULE EVERY 1 DAY
DO
BEGIN
    UPDATE CUSTOMER_BOOKING_DETAILS
    SET STATUS = 'CHECKING'
    WHERE DATE(DROP_OFF_DATE) = CURDATE();
END$$

-- Event to update bookings from CHECKING to EXTENDED after 1 day
CREATE EVENT IF NOT EXISTS update_checking_to_extended
ON SCHEDULE EVERY 1 DAY
DO
BEGIN
    UPDATE CUSTOMER_BOOKING_DETAILS
    SET STATUS = 'EXTENDED'
    WHERE STATUS = 'CHECKING'
      AND DATE(DROP_OFF_DATE) < CURDATE();
END$$

DELIMITER ;
